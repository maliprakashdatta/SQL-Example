
CREATE DATABASE IF NOT EXISTS stepupdb;

USE stepupdb;
CREATE TABLE customer (
	customer_id INTEGER,
	name VARCHAR(50),
	city VARCHAR(28)
);
CREATE TABLE department (
dept_id INTEGER,
name VARCHAR(50),
building_name VARCHAR(70)
);

CREATE TABLE department (
	dept_id INTEGER PRIMARY KEY,
	name VARCHAR(50),
	building_name VARCHAR(70)
);


SELECT * FROM department;

ALTER TABLE department
ADD COLUMN location VARCHAR(75);

ALTER TABLE department
DROP COLUMN location;

DROP TABLE department;

INSERT INTO department(dept_id, name, building_name, location) VALUES (1, 'Sales', 'Sales Commodity Complex', 'Mumbai');

INSERT INTO department(name, dept_id, location, building_name)
VALUES ('Purchase', 2, 'Delhi', 'Purchases Commodity Complex');

DELETE FROM department;

SELECT * FROM department WHERE dept_id > 950;

SELECT * FROM department;
DELETE FROM department WHERE dept_id > 950;
SELECT * FROM department;

TRUNCATE TABLE department;

SELECT * FROM department;

UPDATE department
SET location = 'Kolkata'
WHERE dept_id = 4 AND name = 'Research and Development';

SELECT * FROM department WHERE dept_id = 4 AND name = 'Research and Development';

SELECT count(*) FROM department;

SELECT name, count(*) as total_dept_count
FROM department
GROUP BY name
HAVING total_dept_count > 80;

SELECT DISTINCT(name) FROM department;

INSERT INTO department(dept_id, name, building_name, location) VALUES
(1001,'Support 123','Northport','Kalpower');

------------------------------------------------
CREATE TABLE marks(
	id INTEGER,
    name VARCHAR(120),
    marathi INTEGER,
    english INTEGER,
	maths INTEGER
);

SELECT * FROM marks;

SELECT max(marathi) FROM marks;
SELECT min(marathi) FROM marks;

SELECT * FROM marks ORDER BY marathi DESC LIMIT 3;
SELECT * FROM marks ORDER BY marathi ASC LIMIT 1;

SELECT AVG(marathi), AVG(english),AVG(maths) FROM marks;

SELECT * FROM marks ORDER BY marathi DESC LIMIT 3;

SELECT *, dense_rank() OVER(ORDER BY marathi DESC) FROM marks;

SELECT * FROM marks LIMIT 25 OFFSET 35;
